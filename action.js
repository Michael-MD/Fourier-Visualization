

// create canvas
canvas = document.createElement("canvas");

c_width = 1200; c_height = 600;
canvas.width = c_width;
canvas.height = c_height;

document.getElementById("draw").appendChild(canvas);

canvas.style.backgroundColor = "black";




//draw
ctx = canvas.getContext("2d");
ctx.strokeStyle = "#FFFFFF";	//stroke color
ctx.fillStyle = "white";

function coord(coordinate) { //converts cartesian to native
	return [coordinate[0] + c_width/2, -coordinate[1] + c_height/2];
}

function icoord(coordinate_n) { //converts native to cartesian
	return [coordinate_n[0] - c_width/2, -coordinate_n[1] + c_height/2];
}

function circ(c_params) {	// c_params = [center,r]
	center = coord(c_params[0]);
	ctx.beginPath();
	ctx.arc(center[0],center[1], c_params[1],0,2* Math.PI);
	ctx.stroke();
}

function ray(c_params, theta) {	//draws ray with cirle params and angle
	center = coord(c_params[0]);
	r = c_params[1];
	ctx.moveTo(center[0], center[1]);
	ctx.lineTo(center[0] + r*Math.cos(theta), center[1] - r*Math.sin(theta));
	ctx.stroke();

	//point
	point_x = 10; point_y = 10;	//point size
	p_center = [center[0] + r*Math.cos(theta) - point_x/2, center[1] - r*Math.sin(theta) - point_y/2];
	
	ctx.fillRect( p_center[0], p_center[1] ,point_x,point_y);

	return icoord([ p_center[0] + point_x/2, p_center[1] +  point_y/2]);
}



function wipe() {	//clear canvas
	ctx.clearRect(0, 0, c_width, c_height);
}

function phasor(c_params, theta) {
	circ(c_params);
	return ray(c_params, theta);
}


function tracer(shape) {	// traces out shape
	for(i=0; i<shape.length;i++) {
		center = coord(shape[i]);

		point_x = 5; point_y = 5;
		ctx.fillRect( center[0], center[1] ,point_x,point_y);
	}
}


// draw epicycles
function mag(C) { return Math.sqrt( Math.pow(C[0],2) + Math.pow(C[1],2) ); }
function arg(C) { return Math.atan2(C[1],C[0]); }


/*ft = [ 
	[10.72,16.52],
	[-12.64,20.90],
	[-135.66,-45.57],
	[-44.85,-23.71],
	[66.75,-53.07]
 ];

 ph = [
 	0,
 	1,
 	-1,
 	2,
 	-2
 ];
*/

ft = [[-0.0912677, 
  0.0441499], [0.00525548, -0.106467], [0.0941833, -0.0165454], 
[0.0641185, 0.0273728], [-0.0348848, 
  0.0107391], [0.0460397, -0.0319375], [0.176255, -0.0582693], 
[-0.133701, 0.0607943], [-0.067988, 0.0221182], [0.0915281, 
  0.0325282], [-0.0760161, 0.0824057], [0.038624, 
  0.041671], [-0.0250027, 0.0130666], [0.0488584, 
  0.22182], [-0.0843034, -0.0817981], [-0.123329, -0.106811], 
[0.143518, -0.0273118], [-0.0685669, 
  0.0185458], [0.0100042, -0.04903], [0.0406877, -0.0681049], 
[0.0890245, 0.131892], [-0.0496357, -0.0526213], [0.122847, 
  0.0450359], [-0.0100828, -0.0216507], [-0.117373, 
  0.102826], [-0.0090541, -0.309772], [0.00729357, 
  0.0106389], [-0.14036, 0.0252623], [-0.119952, 
  0.0202659], [0.0958347, -0.0892242], [0.111002, 
  0.0644263], [-0.103798, 0.182424], [0.047986, -0.108027], [0.114777,
   0.00488121], [0.00592937, 
  0.0801926], [0.044664, -0.0081734], [0.066527, -0.150808], 
[-0.0701163, 0.0177798], [-0.14608, 
  0.0680664], [0.0528321, -0.0249557], [0.075876, 
  0.0442998], [0.00209331, 
  0.079348], [-0.120808, -0.109906], [0.0377624, -0.0565022], 
[0.0420189, 
  0.065803], [-0.0529072, -0.084167], [0.13485, -0.041043], 
[0.0934947, 
  0.162964], [0.0533931, -0.0893513], [0.0686547, -0.0751664], 
[0.104792, 0.115113], [-0.0285371, 
  0.15622], [0.00540971, -0.46515], [0.112855, -0.223163], [0.0492943,
   0.0829104], [-0.285148, 
  0.0385326], [0.132144, -0.201961], [0.208273, 
  0.0330665], [-0.0734707, 0.430716], [0.0698914, 
  0.101088], [0.0207267, -0.0358297], [-0.129216, 
  0.155221], [0.101253, 0.0842899], [0.112293, -0.277383], [0.102575, 
  0.0548897], [-0.0258979, -0.0963376], [0.00587, 
  0.0936758], [0.247048, 0.170899], [0.0482478, 
  0.0926106], [-0.222974, -0.141951], [-0.0112875, -0.0911644], 
[0.169081, -0.109372], [-0.131191, -0.32469], [-0.0215451, 
-0.0136294], [-0.0262936, 0.0390132], [-0.224017, 
  0.135547], [-0.131241, -0.166318], [0.0975533, 
  0.177971], [-0.0162153, 
  0.388783], [-0.19793, -0.120814], [-0.014491, -0.0378783], 
[0.028706, 
  0.184333], [0.16343, -0.146667], [-0.255676, -0.140118], 
[0.0971592, -0.223142], [-0.428896, -0.0197794], [0.0111251, 
  0.246669], [0.129488, -0.416154], [-0.00870804, 
  0.0872747], [-0.126349, -0.119049], [0.0863601, -0.300309], 
[0.230392, 
  0.0561283], [-0.455989, -0.0862428], [0.0282117, -0.093517], 
[-0.00262309, -0.307138], [-0.0875508, 0.027593], [-0.226768, 
  0.0516655], [-0.0696629, -0.304039], [0.177091, -0.146144], 
[-0.17456, -0.576063], [0.0798701, -0.1401], [0.332835, -0.11649], 
[-0.0448289, 0.162388], [-0.477974, -0.645718], [-0.343009, 
  0.533805], [0.179066, 
  0.232801], [-0.633827, -0.23667], [0.0258353, -0.0997943], 
[0.258045, -0.51471], [-0.339343, -0.539631], [-0.0076664, 
-0.240275], [0.213134, 
  0.0974788], [-0.552844, -0.374972], [0.100119, -0.402777], 
[-0.615472, -1.00717], [-0.138594, 0.147352], [0.0360206, 
  0.027014], [0.559474, 0.377524], [0.184663, -0.14554], [-1.01569, 
  0.208292], [0.150187, -0.751686], [0.206748, 0.220776], [0.543373, 
  0.985477], [-1.00119, -0.655764], [0.859839, -0.540591], [0.3236, 
  0.017934], [-0.69429, 
  0.459397], [-0.396317, -0.533073], [0.488635, -0.814459], 
[0.0693269, 
  0.532426], [-1.48461, -2.20591], [-0.536478, -1.2985], [2.38102, 
  0.644837], [-1.39565, -0.273522], [-0.648464, 
  0.566212], [1.5836, -0.0558382], [0.0937969, 
  1.10522], [-0.957159, -2.19395], [2.57247, -2.58192], [0.649211, 
  1.47568], [0.265394, 
  0.216755], [0.778685, -2.86623], [-3.56469, -0.407541], [0.329735, 
-3.17617], [-6.8946, -0.195866], [4.56674, -2.68144], [1.82494, 
  7.6941], [5.39538, -12.3384], [-7.18734, -1.60678], [-27.4066, 
-38.8127], [-8.50286, -11.7208], [0.364568, 7.18867], [-1.38752, 
  0.912131], [5.32374, -20.4192], [-4.10224, -0.30823], [-8.16896, 
  1.31162], [-1.20499, -7.23952], [7.26115, 
  1.91103], [-3.62694, -0.232106], [0.525041, -1.58311], [0.860132, 
-2.19428], [-0.116919, 2.01889], [0.665896, 
  1.41621], [-1.13659, -2.45178], [0.150517, 1.40296], [0.00308211, 
  0.733004], [-1.33071, -2.0066], [1.32572, -0.926595], [0.621658, 
  0.688056], [-0.456203, 0.290285], [0.920372, -0.941543], [-0.081611,
   1.12801], [-0.48697, 0.730023], [-0.447035, -0.20279], [0.229, 
  0.57207], [-0.141583, 0.566009], [0.459859, -0.253051], [0.580999, 
  0.270222], [0.240209, 0.490316], [-0.62962, -0.382624], [0.363985, 
  0.404028], [-0.223697, -0.489717], [-1.05872, -0.254796], 
[-0.193101, -0.565026], [-0.0770322, 
  0.37104], [0.144476, -0.0724354], [-0.840162, 0.0906927], [0.177222,
   0.0453899], [-0.168917, -0.295663], [-0.173537, 
  0.781588], [0.250035, -0.458033], [-0.690532, -0.131603], 
[-0.305923, -0.0712092], [-0.148193, -0.177078], [0.00783393, 
-0.103321], [0.295345, 0.442677], [-0.0514323, 
  0.298503], [0.00575914, -0.464346], [0.2834, -0.0154565], 
[-0.0234132, 
  0.484611], [0.102222, -0.125373], [-0.136794, -0.0376179], 
[0.0416915, 0.464224], [-0.468265, 0.190854], [0.07572, 
  0.162634], [0.419573, 0.435846], [-0.214815, 
  0.485075], [-0.0826447, -0.201792], [0.183459, -0.322895], 
[0.122151, 
  0.28499], [-0.285738, -0.136945], [0.0480012, -0.179349], 
[-0.0722685, 0.097456], [-0.193314, 
  0.159483], [0.0897021, -0.0787237], [-0.0345314, -0.196151], 
[0.308982, 
  0.289592], [-0.000289193, -0.306527], [0.148489, -0.211589], 
[0.108054, -0.0632928], [-0.147511, 
  0.0739665], [-0.0296411, -0.174641], [0.0650639, 
  0.183534], [-0.299361, 0.0712015], [-0.0646536, 
  0.0245681], [0.149859, 0.0563027], [-0.00245427, 
  0.162824], [-0.0166233, 
  0.205054], [-0.00215392, -0.253515], [0.100083, 
  0.289902], [-0.05883, -0.128731], [0.113005, -0.0549286], 
[-0.015599, 
  0.243827], [0.125226, -0.0320261], [-0.132257, -0.0527469], 
[0.152536, 0.260514], [0.124678, -0.0190828], [-0.150869, 
  0.172962], [-0.132944, -0.0423949], [0.00101316, -0.10271], 
[-0.0478491, -0.164019], [-0.189804, -0.0990376], [0.262549, 
-0.0147503], [-0.0914372, 
  0.00260216], [0.142443, -0.0557059], [-0.0161187, -0.0917102], 
[0.201981, 0.0145652], [0.114025, 0.00519933], [-0.235658, 
  0.00191155], [0.0598481, 0.0454972], [-0.16706, 
  0.110977], [-0.123181, -0.0833963], [0.00817517, -0.0321192], 
[-0.0899021, 0.152413], [-0.0567782, 
  0.0507566], [0.144212, -0.152512], [0.0224577, 
  0.0915945], [-0.139966, -0.0134182], [-0.0849891, -0.082147], 
[0.130893, -0.204062], [-0.0635982, 
  0.20954], [-0.117725, -0.0138632], [0.186896, -0.074926], 
[0.00386615, 0.135287], [-0.0963857, 
  0.0905256], [-0.0563282, -0.0336673], [0.11497, -0.127175], 
[-0.0405522, 0.00237931], [-0.2717, 
  0.00469271], [0.232289, -0.146459], [0.0265989, 
  0.000424603], [-0.0450947, 
  0.18982], [-0.116757, -0.0670369], [0.0752207, 
  0.0219871], [-0.125773, 0.0273086], [-0.0406155, 
  0.0245187], [0.129816, -0.160722], [-0.156124, 
  0.0987282], [0.0533834, 
  0.0664355], [-0.0858633, -0.0535677], [0.0939638, 
  0.134039], [-0.0960178, 
  0.0870331], [-0.0510476, -0.0843687], [0.0684052, 
  0.0297198], [0.0216246, -0.00327125], [-0.00806729, 
  0.0431687], [0.0774396, -0.142358], [0.023638, 
  0.010827], [-0.0669839, 
  0.0150118], [0.103605, -0.129639], [-0.0693657, 
  0.0693155], [-0.00917134, -0.00789597], [-0.0204619, -0.0649089], 
[0.0340345, -0.0266428], [-0.0354633, 
  0.158659], [0.0188746, -0.00369055], [-0.02323, -0.0363609], 
[-0.0226088, 0.138801], [-0.0544761, 
  0.105812], [0.0188868, -0.088055], [0.126765, 0.0788812]];


//create phase
ph = [];
m = Math.floor(ft.length/2);
for(i = 0; i<=2*m;i++) {
	ph.push( i-m );
}


shape = []
time = 0;
c_params = [[0,0],100];

setInterval(function(){ 
	time+=1/m;
	wipe();

	prev = phasor([ [0,0] , 30*mag(ft[0])/10 ], time*ph[0] + arg(ft[0]) );	//staring circle to set starting and ending positions
	for(let i=1;i<ft.length;i++) {
		prev = phasor([ prev, 30*mag(ft[i])/10 ], time*ph[i] +  arg(ft[i]) );
		
	}
	shape.push(prev);
    tracer(shape);


}, 30);

